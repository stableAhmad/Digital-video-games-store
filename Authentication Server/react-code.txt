
------------------kc module notes

import Keycloak from "keycloak-js";

const _kc = new Keycloak('/keycloak.json')


const initKeycloak =  (onAuthenticatedCallback) => {
	_kc.init({
		onload: 'check-sso',
		silentCheckSsoRedirectUri: window.location.origin + '/slient-check-sso.html',
	pkceMethod: '5256'}).then((authenticated) => {
		if(authenticated) {
			onAuthenticatedCallback();
		} else {
		console.warn("not authenticated")
		doLogin();
		}
		})
	};

const doLogin = _kc.login;
const doLogout = _kc.logout;

const getToken = () => _kc.token;

const updateToken = (successCallback) =>
	_kc.updateToken(5)
	.then(successCallback)
	.catch(doLogin)
const getUsername = () => _kc.tokenParsed?.preferred_username;
const firstName = () => _kc.tokenParsed?.given_name;
const hasRole = (roles) => roles.some( (role) => _kc.hasRealmRole(role));

const UserService = {
	initKeycloak,
	doLogin,
	doLogout,
	getToken,
	updateToken,
	
	
